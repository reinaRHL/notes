'use strict';

const t = require('tap');
const fs = require('fs');
const path = require('path');

require('../lib')(module, require);

const filename = path.join(__dirname, 'data.js');

fs.writeFileSync(
  filename,
  `
    exports.test1 = 1;
  `
);

t.same(require('./data'), {
  test1: 1
});

fs.writeFileSync(
  filename,
  `
    exports.test1 = 1;
    exports.test2 = 2;
  `
);

t.same(require('./data'), {
  test1: 1
});

t.same(require.fresh('./data'), {
  test1: 1,
  test2: 2
});

fs.unlinkSync(filename);
